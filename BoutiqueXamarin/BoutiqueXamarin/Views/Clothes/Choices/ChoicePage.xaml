<?xml version="1.0" encoding="utf-8" ?>
<TabbedPage xmlns="http://xamarin.com/schemas/2014/forms"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:behaviors="http://prismlibrary.com"
             xmlns:choiceViewModelItems="clr-namespace:BoutiqueXamarin.ViewModels.Clothes.Choices.ChoiceViewModelItems;assembly=BoutiqueXamarin"
             xmlns:viewModels="clr-namespace:BoutiqueXamarin.ViewModels.Clothes.Choices;assembly=BoutiqueXamarin"
             x:Class="BoutiqueXamarin.Views.Clothes.Choices.ChoicePage"
             NavigationPage.HasNavigationBar="False"
             x:DataType="{x:Type viewModels:ChoiceViewModel}"
             ItemsSource="{Binding ChoiceGenderViewModelItems}">
    <TabbedPage.ItemTemplate>
        <DataTemplate x:DataType="{x:Type choiceViewModelItems:ChoiceGenderViewModelItem}">
            <ContentPage Title="{Binding GenderName}">
                <ContentPage.Resources>
                    <DataTemplate x:Key="ChoiceCategory" 
                                  x:DataType="{x:Type choiceViewModelItems:ChoiceCategoryViewModelItem}">
                        <TextCell Text="{Binding CategoryName}" />
                    </DataTemplate>
                    <DataTemplate x:Key="ChoiceClothesType" 
                                  x:DataType="{x:Type choiceViewModelItems:ChoiceClothesTypeViewModelItem}">
                        <ViewCell>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="0.1*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <Label Grid.Column="1" 
                                       Text="{Binding ClothesTypeName}"
                                       VerticalTextAlignment="Center"/>
                            </Grid>
                        </ViewCell>
                    </DataTemplate>
                    <choiceViewModelItems:ChoiceDataTemplateSelector x:Key="ChoiceSelector"
                                                                 CategoryTemplate="{StaticResource ChoiceCategory}"
                                                                 ClothesTypeTemplate="{StaticResource ChoiceClothesType}" />
                </ContentPage.Resources>
                <ListView ItemsSource="{Binding ChoiceBaseViewModelItems}" 
                          ItemTemplate="{StaticResource ChoiceSelector}"
                          SelectedItem="{Binding SelectedChoiceBaseViewModelItem, Mode=TwoWay}">
                    <ListView.Behaviors>
                        <behaviors:EventToCommandBehavior EventName="ItemTapped"
                                                          Command="{Binding ChoiceBaseTapCommand}"
                                                          CommandParameter="{Binding SelectedChoiceBaseViewModelItem}" />
                    </ListView.Behaviors>
                </ListView>
            </ContentPage>
        </DataTemplate>
    </TabbedPage.ItemTemplate>
</TabbedPage>